<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RCPIT | Question Paper Portal</title>
  <style>
    /* ... (Your existing styles remain exactly the same) ... */
    :root { --bg: #f7eae0; --blue: #0a57b5; --blue-hover: #0c62c9; --text: #0b2740; --input-bg: #fff; --input-border: #ddd; --error-red: #d9534f; --card-bg: #fff; }
    body.dark { --bg: #1e1e1e; --text: #eee; --input-bg: #333; --input-border: #444; --blue: #4a90e2; --blue-hover: #5aa1f3; --card-bg: #2d2d2d; }
    * { box-sizing: border-box; }
    body { margin: 0; background: var(--bg); color: var(--text); font: 16px/1.5 'Inter', system-ui, sans-serif; transition: background 0.3s, color 0.3s; }
    .wrapper { min-height: 100dvh; display: grid; place-items: center; padding: 32px 16px; }
    .card { width: min(450px, 92vw); display: none; flex-direction: column; gap: 16px; background: var(--card-bg); border-radius: 18px; padding: 24px; box-shadow: 0 8px 18px rgba(0, 0, 0, 0.1); }
    .breadcrumbs { font-size: 13px; margin-bottom: 8px; display: flex; flex-wrap: wrap; gap: 4px; color: var(--blue); font-weight: 500; }
    .breadcrumbs span::after { content: ' â€º'; color: var(--text); opacity: 0.5; margin-left: 4px; }
    .breadcrumbs span:last-child { color: var(--text); opacity: 0.7; }
    .breadcrumbs span:last-child::after { content: ''; }
    h1 { margin: 0; font-weight: 700; font-size: 24px; text-align: center; }
    p.subtitle { margin: 0; text-align: center; opacity: .8; font-size: 14px; }
    .input-group input, .search-box { padding: 14px; border-radius: 10px; border: 1px solid var(--input-border); background-color: var(--input-bg); font-size: 16px; color: var(--text); width: 100%; }
    .option { display: block; background: var(--blue); color: #fff; padding: 16px; border-radius: 14px; text-align: center; font-weight: 600; cursor: pointer; border: none; transition: transform .08s ease, background .15s ease; text-decoration: none; margin-bottom: 10px; width: 100%; }
    .option:hover { background: var(--blue-hover); transform: translateY(-1px); }
    .btn-back { background: #6c757d; margin-top: 8px; }
    #subjectList, #paperTypeButtons { display: flex; flex-direction: column; gap: 10px; }
    .dark-toggle { position: fixed; top: 10px; right: 10px; background: var(--blue); color: white; border: none; padding: 10px; border-radius: 8px; cursor: pointer; z-index: 1000; }
    .logo-container { display: flex; justify-content: center; margin-bottom: 10px; }
    .logo { width: 100px; height: auto; }
  </style>
</head>
<body>
  <button class="dark-toggle" onclick="document.body.classList.toggle('dark')">ðŸŒ“</button>
  
  <main class="wrapper">
    <section class="card" id="loginPage">
      <div class="logo-container"><img src="https://www.rcpit.ac.in/uploads/1599837268.png" alt="Logo" class="logo"></div>
      <h1>Welcome Back</h1>
      <p class="subtitle">Please sign in to continue</p>
      <form id="loginForm" style="display:flex; flex-direction:column; gap:16px;">
        <input type="text" id="username" class="search-box" placeholder="User ID" required>
        <input type="password" id="password" class="search-box" placeholder="Password" required>
        <button type="submit" class="option">Sign In</button>
        <p id="loginError" style="color:var(--error-red); display:none; text-align:center;">Invalid credentials!</p>
      </form>
    </section>

    <section class="card" id="branchPage">
      <h1>Select Branch</h1>
      <div id="branchButtons"></div>
    </section>

    <section class="card" id="studyPage">
      <div class="breadcrumbs" id="bc-study"></div>
      <h1 id="branchTitle"></h1>
      <div id="studyYearButtons"></div>
      <button class="option btn-back" onclick="showPage('branchPage')">â¬… Back</button>
    </section>

    <section class="card" id="yearPage">
      <div class="breadcrumbs" id="bc-year"></div>
      <h1 id="yearTitle"></h1>
      <div id="academicYearButtons"></div>
      <button class="option btn-back" onclick="handleBackFromYear()">â¬… Back</button>
    </section>

    <section class="card" id="subjectPage">
      <div class="breadcrumbs" id="bc-subject"></div>
      <h1 id="subjectTitle"></h1>
      <input type="text" id="subjectSearch" class="search-box" placeholder="Search..." oninput="filterSubjects()">
      <div id="subjectList" style="margin-top:10px;"></div>
      <button class="option btn-back" onclick="showPage('yearPage')">â¬… Back</button>
    </section>

    <section class="card" id="paperTypePage">
      <div class="breadcrumbs" id="bc-paper"></div>
      <h1>Select Paper</h1>
      <p class="subtitle" id="paperTypeSubtitle"></p>
      <div id="paperTypeButtons" style="margin-top:10px;"></div>
      <button class="option btn-back" onclick="showPage('subjectPage')">â¬… Back</button>
    </section>
  </main>

  <script>
    // âœ… No Firebase Configuration Needed!
    const subjects = {
      "First Year": ["Chemistry", "Physics", "Mathematics I", "B.E.E.& D.E.", "Engineering Mechanics", "E.C.S.", "Mathematics II"],
      "Computer Science & Engineering": { 
        SY: ["DSA", "OOP", "Discrete Mathematics", "COA"], 
        TY: ["DBMS", "OS", "Computer Networks", "Theory of Computation"], 
        LY: ["Compiler Design", "AI", "ML", "Big Data"] },
      "IT": { 
        SY: ["DSA", "Web Tech", "OOP", "COA"], 
        TY: ["DBMS", "OS", "CN", "SEPM"], 
        LY: ["AI", "Cloud Computing", "Cyber Security", "Big Data"] },
      "E&TC": { 
        SY: ["Electronic Devices", "Digital Electronics", "Signals & Systems", "Maths III"], 
        TY: ["Microprocessors", "Communication Systems", "Control Systems", "VLSI Design"], 
        LY: ["Embedded Systems", "Wireless Communication", "IoT", "Advanced VLSI"] }
      // ... Add other branches here ...
    };

    let selections = { branch: '', study: '', year: '', subject: '' };

    function showPage(id) {
      document.querySelectorAll('.card').forEach(c => c.style.display = 'none');
      document.getElementById(id).style.display = 'flex';
      updateBreadcrumbs();
    }

    function updateBreadcrumbs() {
      const crumbs = [
        { id: 'bc-study', path: [selections.branch] },
        { id: 'bc-year', path: [selections.branch, selections.study] },
        { id: 'bc-subject', path: [selections.branch, selections.study, selections.year] },
        { id: 'bc-paper', path: [selections.branch, selections.study, selections.year, selections.subject] }
      ];
      crumbs.forEach(c => {
        const el = document.getElementById(c.id);
        if (el) el.innerHTML = c.path.filter(x => x).map(p => `<span>${p}</span>`).join('');
      });
    }

    document.getElementById('loginForm').onsubmit = (e) => {
      e.preventDefault();
      if(document.getElementById('username').value === 'admin' && document.getElementById('password').value === '1234') {
        renderBranches();
        showPage('branchPage');
      } else {
        document.getElementById('loginError').style.display = 'block';
      }
    };

    function renderBranches() {
      const container = document.getElementById('branchButtons');
      container.innerHTML = '';
      Object.keys(subjects).forEach(b => {
        const btn = document.createElement('button');
        btn.className = 'option';
        btn.textContent = b;
        btn.onclick = () => {
          selections.branch = b;
          if(b === 'First Year') {
            selections.study = 'FY';
            renderYears();
            showPage('yearPage');
          } else {
            renderStudyYears();
            showPage('studyPage');
          }
        };
        container.appendChild(btn);
      });
    }

    function renderStudyYears() {
      const container = document.getElementById('studyYearButtons');
      container.innerHTML = '';
      document.getElementById('branchTitle').textContent = selections.branch;
      ['SY', 'TY', 'LY'].forEach(s => {
        const btn = document.createElement('button');
        btn.className = 'option';
        btn.textContent = s;
        btn.onclick = () => { selections.study = s; renderYears(); showPage('yearPage'); };
        container.appendChild(btn);
      });
    }

    function renderYears() {
      const container = document.getElementById('academicYearButtons');
      container.innerHTML = '';
      document.getElementById('yearTitle').textContent = `${selections.branch} - ${selections.study}`;
      ['2025-26', '2024-25', '2023-24'].forEach(y => {
        const btn = document.createElement('button');
        btn.className = 'option';
        btn.textContent = y;
        btn.onclick = () => { selections.year = y; renderSubjects(); showPage('subjectPage'); };
        container.appendChild(btn);
      });
    }

    function renderSubjects() {
      const container = document.getElementById('subjectList');
      container.innerHTML = '';
      document.getElementById('subjectTitle').textContent = "Select Subject";
      const list = selections.branch === 'First Year' ? subjects["First Year"] : (subjects[selections.branch][selections.study] || []);
      list.forEach(s => {
        const btn = document.createElement('button');
        btn.className = 'option';
        btn.textContent = s;
        btn.onclick = () => { selections.subject = s; renderPaperTypes(); showPage('paperTypePage'); };
        container.appendChild(btn);
      });
    }

    function filterSubjects() {
      const query = document.getElementById('subjectSearch').value.toLowerCase();
      document.querySelectorAll('#subjectList .option').forEach(btn => {
        btn.style.display = btn.textContent.toLowerCase().includes(query) ? 'block' : 'none';
      });
    }

    function renderPaperTypes() {
      const container = document.getElementById('paperTypeButtons');
      container.innerHTML = '';
      document.getElementById('paperTypeSubtitle').innerHTML = `Papers for <b>${selections.subject}</b>`;
      
      const types = selections.branch === 'First Year' ? 
        [{l:"TT-I Group A", v:"TT-I-A"}, {l:"TT-II Group A", v:"TT-II-A"}, {l:"EndSem A", v:"EndSem-A"}, {l:"Re-EndSem A", v:"ReEndSem-A"}] :
        [{l:"TT-I", v:"TT-I"}, {l:"TT-II", v:"TT-II"}, {l:"End Semester", v:"EndSemester"}, {l:"Re-End Semester", v:"ReEndSemester"}];

      types.forEach(t => {
        const btn = document.createElement('button');
        btn.className = 'option';
        btn.textContent = t.l;
        btn.onclick = () => openFile(t.v);
        container.appendChild(btn);
      });
    }

    function openFile(type) {
      const safe = s => s.replace(/[^a-zA-Z0-9]/g, '');
      const fileName = `${safe(selections.branch)}-${safe(selections.study)}-${safe(selections.year)}-${safe(selections.subject)}-${safe(type)}.pdf`;
      
      // âœ… UPDATED: Look for file in the 'papers' folder
      const url = `papers/${fileName}`;
      
      // Try to open it
      window.open(url, '_blank');
    }

    function handleBackFromYear() {
      if(selections.branch === 'First Year') showPage('branchPage');
      else showPage('studyPage');
    }

    showPage('loginPage');
  </script>
</body>
</html>